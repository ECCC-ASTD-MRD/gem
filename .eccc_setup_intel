#!/bin/bash

# Source this file to:
# - Load profile, Intel compiler. and code-tools for Intel
# - Load libraries
# - Load a script for common setup to all compilers

export COMPILER_SUITE=intel
DOMAIN=`hostname -d`

if [[ -z "${DOMAIN}" || ${DOMAIN} = "science.gc.ca" ]]; then
    if [[ -n "$CRAYPE_VERSION" ]]; then
        . ./ci-env/latest/sles-15-skylake-64/intel-19.0.5.281.sh
        module add craype-hugepages16M
        module add cray-fftw/3.3.8.2
        export COMPILER_VERSION=19.0.5.281
        . r.load.dot rpn/libs/19.7.0
        . r.load.dot rpn/vgrid/6.6.0
        . r.load.dot /home/cpi001/data/ords/packages-ssm
    elif [[ ${ORDENV_DIST} = "rhel" ]]; then
        . ./ci-env/latest/rhel-8-icelake-64/inteloneapi-2022.1.2.sh
        . r.load.dot rpn/libs/19.7.0
        . r.load.dot rpn/vgrid/20220216
        . r.load.dot /home/cpi001/data/ords/packages-ssm
    else
        . ./ci-env/latest/ubuntu-18.04-skylake-64/intel-19.0.3.199.sh
        export COMPILER_VERSION=19.0.3.199
        . r.load.dot rpn/libs/19.7.0
        . r.load.dot rpn/vgrid/6.6.0
        . r.load.dot /home/cpi001/data/ords/packages-ssm
    fi
else
    . ./ci-env/latest/ubuntu-18.04-amd-64/intel-19.0.3.199.sh
    export COMPILER_VERSION=19.0.3.199
    . r.load.dot rpn/libs/19.7.0
    . r.load.dot rpn/vgrid/6.6.0
    . r.load.dot /data/ords/armn/armncpi/packages-ssm
fi

. ./.common_setup ${COMPILER_SUITE}
