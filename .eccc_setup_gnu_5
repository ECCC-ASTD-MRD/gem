#!/bin/bash

# Load compiler and libraries
# add a symbolic link for gem_dbase 
# create build directory according to the compiler called

# Load compiler and libraries
. r.load.dot /ssm/net/hpcs/compilers/gcc-5.1.0/gcc_5.1.0_ubuntu-14.04-amd64-64
. ssmuse-sh -p /ssm/net/hpcs/201402/master/openmpi_1.6.5_ubuntu-12.04-amd64-64

# Add a symbolic link for gem_dbase
GEM_DBASE=/home/ordenv/ssm-domains9/release/gem-data_4.2.0/gem-data_4.2.0_all/share/data/dfiles
[ -e ${GEM_DBASE} ] && [ ! -e gem_dbase ] && ln -sf ${GEM_DBASE} gem_dbase

# Create build directory according to the compiler called
COMP_VERSION=`sources/compiler.sh gfortran`
BUILD_DIR=build-gfortran-$COMP_VERSION
echo mkdir -p sources/$BUILD_DIR
mkdir -p sources/$BUILD_DIR

sed -i s"/.*cmake.buildDirectory.*/           \"cmake.buildDirectory\": \"\${workspaceRoot}\/$BUILD_DIR\",/" goas-devel.code-workspace

